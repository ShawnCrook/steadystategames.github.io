<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hangman â€” Single File</title>
  <style>
    :root{
      --bg:#0f1222; --card:#171a2e; --ink:#eef1ff; --muted:#b7c0ff; --accent:#7aa2ff; --accent-2:#5dd6b0; --danger:#ff6b6b; --warn:#ffb84d;
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font:16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial;
      color:var(--ink); background:radial-gradient(1200px 800px at 10% 10%, #1a1f3b 0%, #0f1222 50%, #0b0e1a 100%);
      display:grid; place-items:center; padding:16px;
    }
    .app{width:min(980px,100%);}
    header{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:16px}
    h1{margin:0; font-size:clamp(20px, 2.6vw, 32px); letter-spacing:.5px}
    .controls{display:flex; gap:8px; flex-wrap:wrap}
    button{
      appearance:none; border:none; background:var(--accent); color:#081021; font-weight:700; padding:10px 14px; border-radius:12px; cursor:pointer;
      transition:transform .05s ease, filter .15s ease, background .2s ease; box-shadow:0 6px 18px rgba(122,162,255,.25);
    }
    button:hover{filter:brightness(1.05)}
    button:active{transform:translateY(1px)}
    button.secondary{background:#2a2f52; color:var(--muted); box-shadow:none}
    button.danger{background:var(--danger); color:white}
    button[disabled]{opacity:.45; filter:grayscale(.2); cursor:not-allowed}

    .grid{display:grid; gap:16px; grid-template-columns:1.1fr .9fr}
    @media (max-width: 800px){
      .grid{grid-template-columns:1fr}
    }

    .card{background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0)); border:1px solid rgba(255,255,255,.06); border-radius:var(--radius); padding:16px}

    .stage{display:grid; place-items:center; background:var(--card)}

    svg{width:100%; height:auto; max-height:420px}
    .muted{color:var(--muted)}

    .word{display:flex; gap:8px; justify-content:center; flex-wrap:wrap; font-variant:tabular-nums}
    .slot{width:36px; height:48px; display:grid; place-items:center; border-bottom:3px solid var(--muted); font-size:28px; font-weight:800}

    .status{display:flex; justify-content:space-between; align-items:center; gap:12px; margin:8px 0 0}
    .lives{font-weight:700}

    .keyboard{display:grid; grid-template-columns:repeat(13, 1fr); gap:8px; margin-top:12px}
    .key{background:#23284a; color:var(--ink); box-shadow:none; font-weight:700; padding:10px 0}
    .key.correct{background:var(--accent-2); color:#06271f}
    .key.wrong{background:#463040; color:#ffdfe6}

    .toast{position:fixed; inset:auto 16px 16px auto; background:#1f2648; border:1px solid rgba(255,255,255,.08); color:var(--muted); padding:10px 12px; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.35); opacity:.95}

    footer{margin-top:8px; font-size:13px; color:var(--muted); text-align:center}
    .pill{display:inline-block; padding:2px 8px; border-radius:999px; background:#23284a; margin-left:6px}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Hangman <span class="pill" id="difficulty-pill">Normal</span></h1>
      <div class="controls">
        <button id="btn-new">New Game</button>
        <button id="btn-sound" class="secondary" aria-pressed="true">ðŸ”Š Sound: On</button>
        <button id="btn-hint" class="secondary">ðŸ’¡ Hint</button>
        <button id="btn-difficulty" class="secondary" title="Cycle difficulty">Difficulty</button>
      </div>
    </header>

    <div class="grid">
      <!-- LEFT: STAGE / SVG HANGMAN -->
      <section class="card stage" aria-live="polite">
        <svg viewBox="0 0 300 300" role="img" aria-label="Hangman gallows">
          <!-- Gallows -->
          <g stroke="#8fa3ff" stroke-width="6" fill="none" stroke-linecap="round">
            <line x1="20" y1="280" x2="280" y2="280"/> <!-- ground -->
            <line x1="60" y1="280" x2="60" y2="40"/>
            <line x1="60" y1="40" x2="190" y2="40"/>
            <line x1="190" y1="40" x2="190" y2="70"/> <!-- rope -->
          </g>
          <!-- Person parts (hidden initially) -->
          <g id="parts" stroke="#ffd3d3" stroke-width="6" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <circle id="p-head" cx="190" cy="95" r="25" style="display:none"/>
            <line id="p-body" x1="190" y1="120" x2="190" y2="185" style="display:none"/>
            <line id="p-arm-l" x1="190" y1="140" x2="160" y2="165" style="display:none"/>
            <line id="p-arm-r" x1="190" y1="140" x2="220" y2="165" style="display:none"/>
            <line id="p-leg-l" x1="190" y1="185" x2="165" y2="230" style="display:none"/>
            <line id="p-leg-r" x1="190" y1="185" x2="215" y2="230" style="display:none"/>
          </g>
        </svg>
      </section>

      <!-- RIGHT: WORD + KEYBOARD -->
      <section class="card">
        <div id="clue" class="muted" style="min-height:22px"></div>
        <div id="word" class="word" aria-live="polite" aria-atomic="true"></div>
        <div class="status">
          <div class="lives">Lives: <span id="lives">6</span></div>
          <div id="message" class="muted"></div>
        </div>
        <div id="keyboard" class="keyboard" aria-label="On-screen keyboard"></div>
      </section>
    </div>

    <footer>
      Type on your keyboard or click the keys. Press <strong>Shift+N</strong> for a new game, <strong>Shift+H</strong> to reveal a hint, and <strong>Shift+S</strong> to toggle sound.
    </footer>
  </div>

  <div id="toast" class="toast" style="display:none"></div>

  <script>
    // ------------------ UTIL: Simple WebAudio Synth ------------------
    const Audio = (() => {
      let ctx; let enabled = true; let masterGain;
      function ensure(){
        if(!ctx){
          ctx = new (window.AudioContext || window.webkitAudioContext)();
          masterGain = ctx.createGain();
          masterGain.gain.value = 0.15; // master volume
          masterGain.connect(ctx.destination);
        }
        if(ctx.state === 'suspended') ctx.resume();
      }
      function tone(freq=440, dur=0.12, type='sine', vol=1){
        if(!enabled) return;
        ensure();
        const osc = ctx.createOscillator();
        const g = ctx.createGain();
        osc.type = type; osc.frequency.value = freq;
        g.gain.value = 0; // quick attack
        osc.connect(g); g.connect(masterGain);
        const now = ctx.currentTime;
        g.gain.linearRampToValueAtTime(0.9*vol, now + 0.01);
        g.gain.exponentialRampToValueAtTime(0.001, now + Math.max(0.03, dur));
        osc.start(); osc.stop(now + dur + 0.03);
      }
      function chord(freqs=[440,550,660], dur=0.25, type='sine', vol=0.8){
        freqs.forEach((f,i)=> setTimeout(()=> tone(f, dur, type, vol), i*5));
      }
      function setEnabled(v){ enabled = v; }
      function isEnabled(){ return enabled; }
      return { tone, chord, setEnabled, isEnabled };
    })();

    // Sound themes
    const SFX = {
      correct(){ Audio.chord([660, 784], 0.12, 'triangle', 0.8); },
      wrong(){ Audio.tone(140, 0.18, 'sawtooth', 0.9); setTimeout(()=>Audio.tone(110, 0.22, 'sawtooth', 0.7), 110); },
      win(){ [660, 880, 1320].forEach((f,i)=> setTimeout(()=>Audio.tone(f, 0.15, 'square', 0.8), i*140)); },
      lose(){ [392, 330, 262].forEach((f,i)=> setTimeout(()=>Audio.tone(f, 0.25, 'sawtooth', 0.9), i*200)); }
    };

    // ------------------ Game Data ------------------
    const DICTS = {
      Easy: [
        'APPLE','BREAD','CHAIR','PLANET','SILVER','PUZZLE','ROCKET','WINTER','MARKET','FLOWER','GUITAR','BUTTON','CASTLE','ENERGY','JUNGLE','LAPTOP','MONKEY','NUGGET','ORANGE','PEBBLE','QUARTZ','RABBIT','SPIDER','TUNNEL','UMBRELLA','VIOLET','WALNUT','XYLOPHONE','YELLOW','ZEBRA'
      ],
      Normal: [
        'ALGORITHM','ASTEROID','BATTERY','CATALYST','DYNAMIC','EQUATION','FEEDBACK','GALAXY','HARMONIC','INTEGRAL','JAVELIN','KEYBOARD','LANGUAGE','MATRIX','NEBULA','OPERATOR','POLYGON','QUANTUM','RESISTOR','SPECTRUM','TERRAFORM','ULTIMATE','VARIABLE','WAVELENGTH','XENOLITH','YTTRIUM','ZIRCONIUM'
      ],
      Hard: [
        'ANEMOMETER','BELLWETHER','CHRONOLOGY','DIAPHANOUS','EPHEMERAL','FRANGIBLE','GOSSAMER','HEGEMONY','INEFFABLE','JURISPRUDENCE','KINDREDSHIP','LUMINESCENT','MNEMONIC','NEUROPLASTIC','OBFUSCATION','PALIMPSEST','QUINTESSENCE','RHAPSODIZE','SYNCHRONICITY','TRANSCENDENT','ULTRAMARINE','VERisimilitude'.toUpperCase(),'WINSOME','XEROPHYTIC','YAWP','ZEITGEIST'
      ]
    };

    const HINTS = {
      APPLE:'Keeps doctors away', BREAD:'Staple food', CHAIR:'You sit on it', PLANET:'Orbits a star', SILVER:'Ag on the table', PUZZLE:'Brain teaser', ROCKET:'Goes whoosh', WINTER:'Cold season', MARKET:'Where you shop', FLOWER:'Blooms', GUITAR:'Six strings', BUTTON:'Fastener', CASTLE:'Medieval stronghold', ENERGY:'Ability to do work', JUNGLE:'Dense forest', LAPTOP:'Portable computer', MONKEY:'Banana fan', NUGGET:'Small lump', ORANGE:'Citrus fruit', PEBBLE:'Small stone', QUARTZ:'Common mineral', RABBIT:'Long ears', SPIDER:'Eight legs', TUNNEL:'Underground passage', UMBRELLA:'Rain shield', VIOLET:'Purple-ish', WALNUT:'Wrinkly nut', XYLOPHONE:'Percussion instrument', YELLOW:'Primary color', ZEBRA:'Striped animal',
      // Normal
      ALGORITHM:'Step-by-step procedure', ASTEROID:'Space rock', BATTERY:'Stores charge', CATALYST:'Speeds up reactions', DYNAMIC:'Ever-changing', EQUATION:'Math statement', FEEDBACK:'Response or loop', GALAXY:'Star system', HARMONIC:'Related to whole-number ratios', INTEGRAL:'Area under curve', JAVELIN:'Thrown spear', KEYBOARD:'Typing tool', LANGUAGE:'System of words', MATRIX:'Grid of numbers', NEBULA:'Cosmic cloud', OPERATOR:'Acts on operands', POLYGON:'Many-sided shape', QUANTUM:'Smallest discrete unit', RESISTOR:'Opposes current', SPECTRUM:'Range of colors', TERRAFORM:'Make a planet habitable', ULTIMATE:'Final or best', VARIABLE:'Symbol that can change', WAVELENGTH:'Distance between peaks', XENOLITH:'Foreign rock fragment', YTTRIUM:'Y in the periodic table', ZIRCONIUM:'Corrosion-resistant metal',
      // Hard
      ANEMOMETER:'Measures wind speed', BELLWETHER:'Trend leader', CHRONOLOGY:'Order of events', DIAPHANOUS:'Light and translucent', EPHEMERAL:'Short-lived', FRANGIBLE:'Easily broken', GOSSAMER:'Fine, filmy', HEGEMONY:'Dominant influence', INEFFABLE:'Beyond words', JURISPRUDENCE:'Theory of law', KINDREDSHIP:'Family relation (archaic-ish)', LUMINESCENT:'Emits light without heat', MNEMONIC:'Memory aid', NEUROPLASTIC:'Brainâ€™s adaptability', OBFUSCATION:'Making obscure', PALIMPSEST:'Reused manuscript', QUINTESSENCE:'Purest example', RHAPSODIZE:'Speak with enthusiasm', SYNCHRONICITY:'Meaningful coincidence', TRANSCENDENT:'Beyond ordinary', ULTRAMARINE:'Deep blue pigment', VERISIMILITUDE:'Appearance of truth', WINSOME:'Charming', XEROPHYTIC:'Drought-tolerant', YAWP:'A loud cry', ZEITGEIST:'Spirit of the age'
    };

    // ------------------ Game State ------------------
    const state = {
      answer:'', letters:[], guessed:new Set(), wrong:0, lives:6, playing:false, difficulty:'Normal', hintText:'', clueVisible:false,
      recent: { Easy: [], Normal: [], Hard: [] }, // last 5 words per difficulty
      recentLimit: 5,
    };

    // ------------------ DOM ------------------
    const $word = document.getElementById('word');
    const $keyboard = document.getElementById('keyboard');
    const $lives = document.getElementById('lives');
    const $message = document.getElementById('message');
    const $btnNew = document.getElementById('btn-new');
    const $btnSound = document.getElementById('btn-sound');
    const $btnHint = document.getElementById('btn-hint');
    const $btnDifficulty = document.getElementById('btn-difficulty');
    const $clue = document.getElementById('clue');
    const $toast = document.getElementById('toast');
    const $difficultyPill = document.getElementById('difficulty-pill');

    function toast(msg, ms=1400){
      $toast.textContent = msg; $toast.style.display='block';
      clearTimeout(toast._t);
      toast._t = setTimeout(()=> $toast.style.display='none', ms);
    }

    // ------------------ Rendering ------------------
    function drawWord(){
      $word.innerHTML = '';
      state.letters.forEach(ch => {
        const slot = document.createElement('div'); slot.className='slot';
        slot.textContent = state.guessed.has(ch) ? ch : '';
        $word.appendChild(slot);
      });
    }

    function setLives(v){ state.lives = v; $lives.textContent = v; }

    function setMessage(msg, color){ $message.textContent = msg||''; if(color) $message.style.color=color; else $message.style.color='var(--muted)'; }

    function buildKeyboard(){
      $keyboard.innerHTML = '';
      const A = 'A'.charCodeAt(0);
      for(let i=0;i<26;i++){
        const ch = String.fromCharCode(A+i);
        const btn = document.createElement('button');
        btn.className = 'key';
        btn.textContent = ch; btn.setAttribute('data-key', ch); btn.setAttribute('aria-label', `Guess ${ch}`);
        btn.addEventListener('click', ()=> handleGuess(ch));
        $keyboard.appendChild(btn);
      }
    }

    function updateKeys(){
      document.querySelectorAll('.key').forEach(k => {
        const ch = k.getAttribute('data-key');
        k.disabled = state.guessed.has(ch);
        k.classList.toggle('correct', state.guessed.has(ch) && state.answer.includes(ch));
        k.classList.toggle('wrong', state.guessed.has(ch) && !state.answer.includes(ch));
      });
    }

    function updateHangman(){
      const used = Math.min(state.wrong, 6);
      const ids = ['p-head','p-body','p-arm-l','p-arm-r','p-leg-l','p-leg-r'];
      ids.forEach((id, idx)=>{
        const el = document.getElementById(id);
        el.style.display = (idx < used) ? 'inline' : 'none';
      });
    }

    function revealWord(){
      document.querySelectorAll('.slot').forEach((s,i)=> s.textContent = state.letters[i]);
    }

    // ------------------ Recent Word Helpers ------------------
    function getRecent(difficulty){
      return state.recent[difficulty] || [];
    }
    function addRecent(difficulty, word){
      const arr = state.recent[difficulty];
      // Avoid consecutive duplicates
      if(arr[0] === word) return;
      arr.unshift(word);
      if(arr.length > state.recentLimit) arr.length = state.recentLimit;
    }

    // ------------------ Game Logic ------------------
    function pickWord(){
      const list = DICTS[state.difficulty];
      const recent = new Set(getRecent(state.difficulty));
      // Prefer any word not in recent
      const candidates = list.filter(w => !recent.has(w));
      if(candidates.length > 0){
        return candidates[Math.floor(Math.random()*candidates.length)];
      }
      // Fallback: all words were in recent â€” pick random from full list
      // (still avoids immediate duplicate via addRecent guard)
      return list[Math.floor(Math.random()*list.length)];
    }

    function startGame(){
      const next = pickWord();
      state.answer = next;
      // Record in recent for this difficulty
      addRecent(state.difficulty, next);

      state.letters = [...state.answer];
      state.guessed.clear();
      state.wrong = 0; setLives(6); state.playing = true; setMessage('');
      // Hint should start hidden
      state.hintText = HINTS[state.answer] || '';
      state.clueVisible = false;
      $clue.textContent = '';

      drawWord(); buildKeyboard(); updateHangman(); updateKeys();
    }

    function endGame(win){
      state.playing = false;
      revealWord();
      if(win){ setMessage('You win! ðŸŽ‰', 'var(--accent-2)'); SFX.win(); toast('Nice! You guessed it.'); }
      else { setMessage('You lose! ðŸ’€', 'var(--danger)'); SFX.lose(); toast(`The word was ${state.answer}.`); }
      // disable remaining keys
      document.querySelectorAll('.key').forEach(k => k.disabled=true);
    }

    function handleGuess(ch){
      if(!state.playing) return;
      ch = ch.toUpperCase();
      if(!/^[A-Z]$/.test(ch) || state.guessed.has(ch)) return;
      state.guessed.add(ch);
      const good = state.answer.includes(ch);
      if(good){
        SFX.correct();
        drawWord();
        if(state.letters.every(c=> state.guessed.has(c))){ endGame(true); }
      } else {
        state.wrong++; setLives(state.lives-1); updateHangman(); SFX.wrong();
        if(state.wrong >= 6){ endGame(false); }
      }
      updateKeys();
    }

    // ------------------ Events ------------------
    document.addEventListener('keydown', (e)=>{
      // Prioritize command combos (Shift+N/S/H)
      const key = e.key;
      if(e.shiftKey && (key === 'N' || key === 'n')){ e.preventDefault(); startGame(); toast('New game'); return; }
      if(e.shiftKey && (key === 'S' || key === 's')){ e.preventDefault(); toggleSound(); return; }
      if(e.shiftKey && (key === 'H' || key === 'h')){ e.preventDefault(); showHint(); return; }

      // Regular letter guesses (unmodified)
      if(key.length === 1 && /[a-z]/i.test(key) && !e.ctrlKey && !e.metaKey && !e.altKey){
        handleGuess(key);
      }
    });

    $btnNew.addEventListener('click', startGame);
    $btnSound.addEventListener('click', toggleSound);
    $btnHint.addEventListener('click', showHint);
    $btnDifficulty.addEventListener('click', cycleDifficulty);

    function toggleSound(){
      const on = !Audio.isEnabled();
      Audio.setEnabled(on);
      $btnSound.textContent = on ? 'ðŸ”Š Sound: On' : 'ðŸ”ˆ Sound: Off';
      $btnSound.setAttribute('aria-pressed', String(on));
      toast(on ? 'Sound enabled' : 'Sound muted');
      if(on) SFX.correct();
    }

    function showHint(){
      if(!state.hintText){ $clue.textContent = 'No hint available.'; return; }
      state.clueVisible = true;
      $clue.textContent = `Hint: ${state.hintText}`;
      // No toast popup for hints
    }

    function cycleDifficulty(){
      const order = ['Easy','Normal','Hard'];
      let i = order.indexOf(state.difficulty);
      state.difficulty = order[(i+1)%order.length];
      $difficultyPill.textContent = state.difficulty;
      toast(`Difficulty: ${state.difficulty}`);
      startGame();
    }

    // ------------------ Init ------------------
    (function init(){
      buildKeyboard(); updateHangman();
      startGame();
    })();
  </script>
</body>
</html>
